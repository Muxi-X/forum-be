syntax = "proto3";

package post;

service PostService {
    rpc CreatePost(CreatePostRequest) returns (Response) {}
    rpc GetPost(Request) returns (Post) {}
    rpc ListMainPost(ListMainPostRequest) returns (ListPostResponse) {}
    rpc ListSubPost(ListSubPostRequest) returns (ListPostResponse) {}
    rpc UpdatePostInfo(UpdatePostInfoRequest) returns (Response) {}

    rpc GetComment(Request) returns (CommentInfo) {}
    rpc CreateComment(CreateCommentRequest) returns (Response) {}

    rpc DeleteItem(Item) returns (Response) {}

    rpc CreateLike(LikeRequest) returns (Response) {}
    rpc RemoveLike(LikeRequest) returns (Response) {}
    rpc ListLikeByUserId(UserIdRequest) returns (ListLikeResponse) {}
}

message ListLikeResponse {
    repeated LikeItem list = 1;
}

message LikeItem {
    uint32 target_id = 1;
    string type_name = 2;
}

message LikeRequest {
    uint32 user_id = 1;
    LikeItem item = 2;
}

message CreateCommentRequest {
    uint32 post_id = 1;
    string type_name = 2;
    uint32 father_id = 3;
    string content = 4;
    uint32 creator_id = 5;
}

message CommentInfo {
    uint32 id = 1;
    string type_name = 2;
    string content = 3;
    uint32 father_id = 4;
    string create_time = 5;
    uint32 creator_id = 6;
    string creator_name = 7;
    string creator_avatar = 8;
    uint32 like_num = 9;
    bool is_liked = 10;
}

message Request {
    uint32 id = 1;
    uint32 user_id = 2;
}

message UserIdRequest {
    uint32 user_id = 1;
}

message Item {
    uint32 id = 1;
    string type_name = 2;
}

message UpdatePostInfoRequest {
    uint32 id = 1;
    string content = 2;
    string title = 3;
    uint32 user_id = 4;
    uint32 category_id = 5;
    repeated string tags = 6;
}

message CreatePostRequest {
    uint32 user_id = 1;
    string content = 2;
    string type_name = 3;
    string title = 4;
    uint32 category_id = 5;
    uint32 main_post_id = 6;
    repeated string tags = 7;
}

message Response {}

message ListMainPostRequest {
    uint32 last_id = 1;
    uint32 offset = 2;
    uint32 limit = 3;
    string type_name = 4;
    uint32 category_id = 5;
    uint32 user_id = 6;
    bool pagination = 7;
}

message ListSubPostRequest {
    uint32 last_id = 1;
    uint32 offset = 2;
    uint32 limit = 3;
    string type_name = 4;
    uint32 main_post_id = 5;
    uint32 user_id = 6;
    bool pagination = 7;
}

message ListPostResponse {
    repeated Post list = 1;
}

message Post {
    uint32 id = 1;
    string title = 2;
    string time = 3;
    uint32 category_id = 4;
    uint32 creator_id = 5;
    string creator_name = 6;
    string content = 7;
    string creator_avatar = 8;
    uint32 comment_num = 9;
    uint32 like_num = 10;
    bool is_liked = 11;
    bool is_favorite = 12;
    repeated CommentInfo comments = 13;
    repeated string tags = 14;
}